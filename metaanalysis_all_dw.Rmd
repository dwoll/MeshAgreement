---
title: 'UNSCEAR SPCaRT - Metaanalysis - Linda Walsh'
subtitle: 'All Sites'
author: 'Daniel Wollschl√§ger'
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  pdf_document: 
    number_sections: yes
    keep_tex: no
    fig_crop: no

header-includes:
    \usepackage{pdflscape}
    \newcommand{\blandscape}{\begin{landscape}}
    \newcommand{\elandscape}{\end{landscape}}
---
    
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE,
                      tidy=FALSE,
                      message=FALSE,
                      warning=FALSE,
                      comment=NA,
                      crop=FALSE,
                      fig_crop=FALSE)

options(replace.assign=TRUE,
        width=75,
        digits=4,
        useFancyQuotes=FALSE,
        show.signif.stars=FALSE,
        scipen=999)

output <- knitr::opts_knit$get("rmarkdown.pandoc.to")
```

```{r echo=FALSE}
#####---------------------------------------------------------------------------
#####---------------------------------------------------------------------------
## load packages
## read data
#####---------------------------------------------------------------------------
#####---------------------------------------------------------------------------

library(dplyr)

source("metaanalysis_global.R")
source("plot_global.R")

## considered cancer sites - will be used in lists to
## identify sub-analyses
cancer_sites <- c("HaemLym",
                  "Sarcoma",
                  "Breast",
                  "Lung",
                  "Gastro",
                  "Thyroid",
                  "Brain")

## used for analysis of all solid cancer
cancer_sites_solid <- c("Sarcoma",
                        "Breast",
                        "Lung",
                        "Gastro",
                        "Thyroid",
                        "Brain")

## names of sensitivity analyses
sens_types <- c("primary",
                "sens_uncorr",
                "sens_synth1",
                "sens_all",
                "sens_only_org",
                "sens_ext_no",
                "sens_children",
                "sens_adults",
                "sens_chemo_no",
                "sens_chemo_yes_adj",
                "sens_brachy_no",
                "sens_org_scale")

## leave-one-out diagnostics forest plot: axis tick marks
loo_forest_breaks <- list(HaemLym  =seq(-0.05, 0.15, by=0.025),
                          Sarcoma  =seq( 0,    1,    by=0.1),
                          Breast   =seq( 0,    0.3,  by=0.05),
                          Lung     =seq( 0,    1,    by=0.1),
                          Gastro   =seq( 0,    0.1,  by=0.02),
                          Thyroid  =seq( 0,    5,    by=0.5),
                          Brain    =seq(-0.2,  1.4,  by=0.2),
                          all_solid=seq( 0.05, 0.15, by=0.01))

## primary analysis metaanalysis forest plot: axis tick marks
prime_forest_breaks <- list(HaemLym  =transf_ERR_to_logRR(c(-0.85, -0.3, 0, 1,  3,  10)),  # 7
                            Sarcoma  =transf_ERR_to_logRR(c(-0.5, 0, 1, 3, 10, 30)),  # 6
                            Breast   =transf_ERR_to_logRR(c(-0.75, -0.2, 0, 0.5, 1,   4)),  # 6
                            Lung     =transf_ERR_to_logRR(c(-0.5, 0, 0.5, 1.5, 3, 5)),   # 7
                            Gastro   =transf_ERR_to_logRR(c(-0.75, -0.3, 0, 0.5, 2, 3)), # 4
                            Thyroid  =transf_ERR_to_logRR(c(-0.9,   0, 5, 20, 100, 600)),   # 6
                            Brain    =transf_ERR_to_logRR(c(-0.5, 0, 1, 3, 5, 20, 50)),
                            all_solid=transf_ERR_to_logRR(c(-0.9, 0, 2, 10, 100, 600)))   # 6

#####---------------------------------------------------------------------------
## load previously generated data and estimates
#####---------------------------------------------------------------------------

d_RR_allL            <- readRDS("d_RR_allL.rda")
d_RR_uniqueL         <- readRDS("d_RR_uniqueL.rda")

d_ERR_allL           <- readRDS("d_ERR_allL.rda")
d_ERR_uniqueL        <- readRDS("d_ERR_uniqueL.rda")
d_ERR_childrenL      <- readRDS("d_ERR_childrenL.rda")
d_ERR_adultsL        <- readRDS("d_ERR_adultsL.rda")
d_ERR_chemo_noL      <- readRDS("d_ERR_chemo_noL.rda")
d_ERR_chemo_yes_adjL <- readRDS("d_ERR_chemo_yes_adjL.rda")
d_ERR_brachy_noL     <- readRDS("d_ERR_brachy_noL.rda")
```

**CAVE** "RR" here may refer to RR, OR, HR

# Haematopoetic / Lymph

```{r}
cancer_site <- "HaemLym"
```

## Primary analysis
### Category RR + CIs

```{r fig.height=6}
plot_categ_rr_ci(d_RR_uniqueL[[cancer_site]], ylim=c(0, 30))
```

### Estimated per-study ERR + CIs with category RR + CIs

```{r fig.height=8}
plot_err_categ_rr_ci(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                     d_RR_uniqueL[[cancer_site]],
                     ylim=c(0, 30), lpos="bottom")
```

### Estimated ERR + CIs with original ERR + CIs

```{r results="asis"}
d_ERR_uniqueL[[cancer_site]]$d_ERR_long %>%
    select(auth_year, from, ERR, ERR_CIlo, ERR_CIup) %>%
    arrange(auth_year, from) %>%
    na.omit() %>%
    knitr::kable(booktabs=TRUE)
```

```{r fig.height=6}
plot_err_org_new(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                 ylim=c(-0.5, 13),
                 lpos=c(0.9, 0.2))
```

### Metaanalysis

```{r, child='metaanalysis_child_primary_meta.Rmd'}
```

Studies with >= 1 effect estimate

```{r}
d_ERR_wide_ma %>%
    filter(!is.na(ERR)) %>%
    count(Study) %>%
    filter(n > 1L)
```

```{r, child='metaanalysis_child_sensitivity.Rmd'}
```

# Sarcoma

```{r}
cancer_site <- "Sarcoma"
```

## Primary analysis
### Category RR + CIs

```{r fig.height=6}
plot_categ_rr_ci(d_RR_uniqueL[[cancer_site]],
                 ylim=c(0, 80))
```

### Estimated per-study ERR + CIs with category RR + CIs

```{r fig.height=8}
plot_err_categ_rr_ci(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                     d_RR_uniqueL[[cancer_site]],
                     ylim=c(0, 80),
                     lpos=c(0.85, 0.12))
```

### Estimated ERR + CIs with original ERR + CIs

```{r results="asis"}
d_ERR_uniqueL[[cancer_site]]$d_ERR_long %>%
    select(auth_year, from, ERR, ERR_CIlo, ERR_CIup) %>%
    arrange(auth_year, from) %>%
    na.omit() %>%
    knitr::kable(booktabs=TRUE)
```

```{r fig.height=6}
plot_err_org_new(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                 ylim=c(-1.2, 23),
                 lpos=c(0.9, 0.2))
```

### Metaanalysis

```{r, child='metaanalysis_child_primary_meta.Rmd'}
```

```{r, child='metaanalysis_child_sensitivity.Rmd'}
```

# Breast

```{r}
cancer_site <- "Breast"
```

## Primary analysis
### Category RR + CIs

```{r fig.height=6}
plot_categ_rr_ci(d_RR_uniqueL[[cancer_site]],
                 ylim=c(0, 10))
```

### Estimated per-study ERR + CIs with category RR + CIs

Note: For Veiga 2019, ERR derived from OR/10 Gy is plotted.

```{r fig.height=8}
d_ERR_Veiga <- d_RR_uniqueL[[cancer_site]] %>%
    filter(auth_year == "Veiga_2019") %>%
    mutate(ERR     =RR-1,
           ERR_CIlo=RR_CIlo-1,
           ERR_CIup=RR_CIup-1,
           from="org") %>%
    select(auth_year, from, ERR, ERR_CIlo, ERR_CIup) %>%
    slice(1)

d_ERR_sub <- d_ERR_uniqueL[[cancer_site]]$d_ERR_long %>%
    filter(!((auth_year == "Veiga_2019") & (from == "org")))

d_ERR_plot <- bind_rows(d_ERR_sub, d_ERR_Veiga)

d_ribbon <- data.frame(d_kPrime=seq(from=min(d_RR_uniqueL[[cancer_site]]$d_kPrime, na.rm=TRUE),
                                    to  =max(d_RR_uniqueL[[cancer_site]]$d_kPrime, na.rm=TRUE),
                                    length.out=2))

d_ERR_ribbon <- d_ERR_plot %>%
    full_join(d_ribbon, by=character()) %>%
    mutate(ERR_CI_Ylo=1 + d_kPrime*ERR_CIlo,
           ERR_CI_Yup=1 + d_kPrime*ERR_CIup)

ggplot(d_RR_uniqueL[[cancer_site]]) +
    geom_point(aes(x=d_kPrime, y=RR_cat)) +
    geom_linerange(aes(x=d_kPrime, y=RR_cat,
                       ymin=RR_cat_CIlo, ymax=RR_cat_CIup)) +
    geom_ribbon(data=d_ERR_ribbon,
                aes(x=d_kPrime, ymin=ERR_CI_Ylo, ymax=ERR_CI_Yup,
                    color=from, fill=from), alpha=0.3, linetype=0) +
    geom_abline(data=bind_rows(d_ERR_sub, d_ERR_Veiga),
                aes(intercept=1, slope=ERR, color=from)) +
    coord_cartesian(ylim=c(0, 15)) +
    facet_wrap(~ auth_year) +
    xlab("Dose [Gy]") +
    ylab("RR") +
    ggpt +
    theme(legend.position=c(0.85, 0.12))
```

Only Svahn-Tapper 2006 (off the charts)

```{r}
d_ERR_ribbon_ST2006 <- d_ERR_ribbon %>%
    filter(auth_year == "Svhn-Tp_2006")

d_ERR_long_ST2006 <- d_ERR_uniqueL[[cancer_site]]$d_ERR_long %>%
    filter(auth_year == "Svhn-Tp_2006")

d_RR_ST2006 <- d_RR_uniqueL[[cancer_site]] %>%
    filter(auth_year == "Svhn-Tp_2006")

ggplot(d_RR_ST2006) +
    geom_point(aes(x=d_kPrime, y=RR_cat)) +
    geom_linerange(aes(x=d_kPrime, y=RR_cat,
                       ymin=RR_cat_CIlo, ymax=RR_cat_CIup)) +
    geom_ribbon(data=d_ERR_ribbon_ST2006,
                aes(x=d_kPrime, ymin=ERR_CI_Ylo, ymax=ERR_CI_Yup,
                    color=from, fill=from), alpha=0.3, linetype=0) +
    geom_abline(data=d_ERR_long_ST2006,
                aes(intercept=1, slope=ERR, color=from)) +
    geom_abline(data=d_RR_ST2006,
                aes(intercept=0, slope=RR)) +
    coord_cartesian(ylim=c(0, 100)) +
    xlab("Dose [Gy]") +
    ylab("RR") +
    facet_grid(~ auth_year) +
    ggpt +
    theme(legend.position="bottom")
```

### Estimated ERR + CIs with original ERR + CIs

```{r results="asis"}
d_ERR_uniqueL[[cancer_site]]$d_ERR_long %>%
    select(auth_year, from, ERR, ERR_CIlo, ERR_CIup) %>%
    arrange(auth_year, from) %>%
    na.omit() %>%
    knitr::kable(booktabs=TRUE)
```

```{r fig.height=6}
plot_err_org_new(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                 ylim=c(-1, 4.5),
                 lpos=c(0.9, 0.2))
```

### Metaanalysis

```{r, child='metaanalysis_child_primary_meta.Rmd'}
```

```{r, child='metaanalysis_child_sensitivity.Rmd'}
```

# Lung

```{r}
cancer_site <- "Lung"
```

## Primary analysis
### Category RR + CIs

```{r fig.height=6}
plot_categ_rr_ci(d_RR_uniqueL[[cancer_site]],
                 ylim=c(0, 20))
```

### Estimated per-study ERR + CIs with category RR + CIs

```{r fig.height=8}
plot_err_categ_rr_ci(d_ERR_uniqueL[[cancer_site]]$d_ERR_long, 
                     d_RR_uniqueL[[cancer_site]],
                     ylim=c(0, 15),
                     lpos="bottom")
```

### Estimated ERR + CIs with original ERR + CIs

```{r results="asis"}
d_ERR_uniqueL[[cancer_site]]$d_ERR_long %>%
    select(auth_year, from, ERR, ERR_CIlo, ERR_CIup) %>%
    arrange(auth_year, from) %>%
    na.omit() %>%
    knitr::kable(booktabs=TRUE)
```

```{r fig.height=6}
plot_err_org_new(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                 ylim=c(-0.2, 2.5),
                 lpos=c(0.9, 0.2))
```

### Metaanalysis

```{r, child='metaanalysis_child_primary_meta.Rmd'}
```

```{r, child='metaanalysis_child_sensitivity.Rmd'}
```

# Gastro

```{r}
cancer_site <- "Gastro"
```

## Primary analysis
### Category RR + CIs

```{r fig.height=6}
plot_categ_rr_ci(d_RR_uniqueL[[cancer_site]],
                 ylim=c(0, 10))
```

### Estimated per-study ERR + CIs with category RR + CIs

```{r fig.height=8}
plot_err_categ_rr_ci(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                     d_RR_uniqueL[[cancer_site]],
                     ylim=c(0, 15),
                     lpos="bottom")
```

### Estimated ERR + CIs with original ERR + CIs

```{r results="asis"}
d_ERR_uniqueL[[cancer_site]]$d_ERR_long %>%
    select(auth_year, from, ERR, ERR_CIlo, ERR_CIup) %>%
    arrange(auth_year, from) %>%
    na.omit() %>%
    knitr::kable(booktabs=TRUE)
```

```{r fig.height=6}
plot_err_org_new(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                 ylim=c(-0.2, 2.5),
                 lpos=c(0.9, 0.2))
```

### Metaanalysis

```{r, child='metaanalysis_child_primary_meta.Rmd'}
```

Studies with >= 1 effect estimate

```{r}
d_ERR_wide_ma %>%
    filter(!is.na(ERR)) %>%
    count(Study) %>%
    filter(n > 1L)
```

```{r, child='metaanalysis_child_sensitivity.Rmd'}
```

# Thyroid

```{r}
cancer_site <- "Thyroid"
```

## Primary analysis - dose threshold 10 Gy
### Category RR + CIs

```{r fig.height=6}
plot_categ_rr_ci(d_RR_uniqueL[[cancer_site]], ylim=c(0, 10))
```

### Estimated per-study ERR + CIs with category RR + CIs

```{r fig.height=8}
plot_err_categ_rr_ci(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                     d_RR_uniqueL[[cancer_site]],
                     ylim=c(0, 15),
                     lpos=c(0.85, 0.12))
```

### Estimated ERR + CIs with original ERR + CIs

```{r results="asis"}
d_ERR_uniqueL[[cancer_site]]$d_ERR_long %>%
    select(auth_year, from, ERR, ERR_CIlo, ERR_CIup) %>%
    arrange(auth_year, from) %>%
    na.omit() %>%
    knitr::kable(booktabs=TRUE)
```

```{r fig.height=6}
plot_err_org_new(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                 ylim=c(-1.2, 20),
                 lpos=c(0.9, 0.2))
```

### Metaanalysis

```{r, child='metaanalysis_child_primary_meta.Rmd'}
```

```{r, child='metaanalysis_child_sensitivity.Rmd'}
```

### Dose threshold 5 Gy

```{r}
dose_thresh <- 5
d_ERR_wide <- readRDS(paste0("d_ERR_thyroid_thresh",
                             sprintf("%.2d", dose_thresh), "_unique_wide.rda"))

d_ERR_wide_ma <- d_ERR_wide %>%
    mutate(## take original ERR+CI if available, else use estimated ERR+CI
           used       =get_used(ERR_org,         ERR_gls,         ERR_lm,         ERR_ext),
           ERR        =coalesce(ERR_org,         ERR_gls,         ERR_lm,         ERR_ext),
           ERR_CIlo   =coalesce(ERR_CIlo_org,    ERR_CIlo_gls,    ERR_CIlo_lm,    ERR_CIlo_ext),
           ERR_CIup   =coalesce(ERR_CIup_org,    ERR_CIup_gls,    ERR_CIup_lm,    ERR_CIup_ext),
           ERR_SE_meta=coalesce(ERR_SE_meta_org, ERR_SE_meta_gls, ERR_SE_meta_lm, ERR_SE_meta_ext)) %>%
    filter(used != "none") %>%
    mutate(Study=Reference) %>%
    select(auth_year, Study, ERR, ERR_CIlo, ERR_CIup, ERR_SE_meta, used)
```

```{r, child='metaanalysis_child_meta.Rmd'}
```

### Dose threshold 20 Gy

```{r}
dose_thresh <- 20
d_ERR_wide <- readRDS(paste0("d_ERR_thyroid_thresh",
                             sprintf("%.2d", dose_thresh), "_unique_wide.rda"))

d_ERR_wide_ma <- d_ERR_wide %>%
    mutate(## take original ERR+CI if available, else use estimated ERR+CI
           used       =get_used(ERR_org,         ERR_gls,         ERR_lm,         ERR_ext),
           ERR        =coalesce(ERR_org,         ERR_gls,         ERR_lm,         ERR_ext),
           ERR_CIlo   =coalesce(ERR_CIlo_org,    ERR_CIlo_gls,    ERR_CIlo_lm,    ERR_CIlo_ext),
           ERR_CIup   =coalesce(ERR_CIup_org,    ERR_CIup_gls,    ERR_CIup_lm,    ERR_CIup_ext),
           ERR_SE_meta=coalesce(ERR_SE_meta_org, ERR_SE_meta_gls, ERR_SE_meta_lm, ERR_SE_meta_ext)) %>%
    filter(used != "none") %>%
    mutate(Study=Reference) %>%
    select(auth_year, Study, ERR, ERR_CIlo, ERR_CIup, ERR_SE_meta, used)
```

```{r, child='metaanalysis_child_meta.Rmd'}
```

# Brain

```{r}
cancer_site <- "Brain"
```

## Primary analysis
### Category RR + CIs

```{r fig.height=6}
plot_categ_rr_ci(d_RR_uniqueL[[cancer_site]],
                 ylim=c(0, 60))
```

### Estimated per-study ERR + CIs with category RR + CIs

```{r fig.height=8}
plot_err_categ_rr_ci(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                     d_RR_uniqueL[[cancer_site]],
                     ylim=c(0, 60),
                     lpos=c(0.85, 0.12))
```

### Estimated ERR + CIs with original ERR + CIs

```{r results="asis"}
d_ERR_uniqueL[[cancer_site]]$d_ERR_long %>%
    select(auth_year, from, ERR, ERR_CIlo, ERR_CIup) %>%
    arrange(auth_year, from) %>%
    na.omit() %>%
    knitr::kable(booktabs=TRUE)
```

```{r fig.height=6}
plot_err_org_new(d_ERR_uniqueL[[cancer_site]]$d_ERR_long,
                 ylim=c(-0.1, 15),
                 lpos=c(0.9, 0.2))
```

### Metaanalysis

```{r, child='metaanalysis_child_primary_meta.Rmd'}
```

```{r, child='metaanalysis_child_sensitivity.Rmd'}
```

# All solid cancer
## Primary analysis
### Metaanalysis

```{r}
tables_err_solid <- paste0("d_ERR_site_", cancer_sites_solid)

d_ERR_wide_ma <- do.call("bind_rows", lapply(tables_err_solid, try_get)) %>%
    filter(used != "none") %>%
    select(-weight) %>%
    rename(ERR_SE_meta=ERR_SE)

cancer_site <- "all_solid"
meta_type   <- "special"
```

```{r, child='metaanalysis_child_meta.Rmd'}
```

Studies with >= 1 effect estimate

```{r}
d_ERR_wide_ma %>%
    count(Study) %>%
    filter(n > 1L)
```

Funnel plot

```{r fig.height=3.5}
if(!inherits(pooled_logRR, "try-error")) {
    funnel(pooled_logRR, atransf=transf_logRR_to_ERR)
}
```

Forest plot

```{r fig.height=8.5}
if(!inherits(pooled_logRR, "try-error")) {
    forest(pooled_logRR,
           xlab="ERR/Gy + 95% CI",
           at=prime_forest_breaks[[cancer_site]],
           atransf=transf_logRR_to_ERR)
}
```

Leave one out

```{r fig.height=7}
if(!inherits(pooled_logRR, "try-error")) {
    l1o <- leave1out(pooled_logRR, transf=transf_logRR_to_ERR)
    l1o %>%
        as.data.frame() %>%
        select(estimate, ci.lb, ci.ub, Q, Qp, tau2, I2) %>%
        mutate(estimate=round(estimate, digits=3L),
               ci.lb   =round(ci.lb,    digits=3L),
               ci.ub   =round(ci.ub,    digits=3L),
               tau2    =round(tau2,     digits=4L),
               I2      =round(I2,       digits=1L))
}
```

Forest plot

```{r fig.height=8}
if(!inherits(pooled_logRR, "try-error")) {
    d_est_ci <- as.data.frame(predict(pooled_logRR, transf=transf_logRR_to_ERR, pi.type="riley")) %>%
        rename(org_ci_lb=ci.lb,
               org_ci_ub=ci.ub) %>%
        mutate(xmin=-0.5,
               xmax=n()+0.5,
               join=TRUE)
    
    d_l1o <- as.data.frame(l1o) %>%
        tibble::rownames_to_column(var="Left_out") %>% 
        mutate(x_num=as.numeric(as.factor(Left_out)),
               x_num_add=seq(from=min(x_num)-0.5, to=max(x_num)+0.5, length.out=n()),
               join=TRUE) %>%
        left_join(d_est_ci, by="join")
    
    ggplot(d_l1o) +
        geom_hline(yintercept=d_est_ci$pred, size=1, color="darkgray") +
        annotate("rect", fill="grey70", alpha=0.5,
                 xmin=min(d_l1o$x_num_add), xmax=max(d_l1o$x_num_add),
                 ymin=min(d_l1o$org_ci_lb), ymax=max(d_l1o$org_ci_ub)) +
        # geom_ribbon(aes(x=x_num_add, ymin=org_ci_lb, ymax=org_ci_ub), fill="grey70", alpha=0.5) +
        geom_point(aes(x=x_num, y=estimate)) +
        geom_linerange(aes(x=x_num, ymin=ci.lb, ymax=ci.ub)) +
        scale_x_continuous(breaks=d_l1o$x_num, labels=d_l1o$Left_out) +
        scale_y_continuous(breaks=loo_forest_breaks[[cancer_site]]) +
        xlab("Without study") +
        ylab("Pooled ERR/Gy RE model") +
        coord_flip() +
        ggpt
}
```

\newpage
\blandscape

# Combined results
## ERRs used as input for metaanalysis

```{r}
tables_err_site <- paste0("d_ERR_site_", cancer_sites)

d_tables_err_all <- do.call("bind_rows", lapply(tables_err_site, try_get)) %>%
    filter(used != "none") %>%
    select(site, Study, everything(), -auth_year)

writexl::write_xlsx(d_tables_err_all, "table_err_all.xlsx")

d_tables_err_all %>%
    knitr::kable()
```

## Metaanalysis results (primary)

```{r}
d_tables_meta_site <- expand.grid(cs=cancer_sites, st=sens_types)
tables_meta_site   <- paste0("d_meta_",
                             d_tables_meta_site$cs, "_",
                             d_tables_meta_site$st)

tables_meta_all <- do.call("bind_rows", lapply(tables_meta_site, try_get)) %>%
    mutate(site=factor(site, levels=cancer_sites),
           type=factor(type, levels=rev(sens_types))) %>%
    select(site, everything())

tables_meta_all %>%
    filter(type == "primary") %>%
    select(-type) %>%
    knitr::kable()
```

\elandscape

## Metaanalysis results (primary, sensitivity and sub-groups)

```{r fig.height=8}
plot_meta_results(tables_meta_all)
```

\newpage

Without thyroid due to different magnitude

```{r fig.height=8}
sites_large_err <- c("Thyroid") # "Sarcoma",  , "Brain"
d_plot <- tables_meta_all %>% filter(!(site %in% sites_large_err))
plot_meta_results(d_plot)
```
